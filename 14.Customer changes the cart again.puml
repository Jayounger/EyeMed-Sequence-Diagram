@startuml
title User clicks Apply insurance
actor Customer
participant FE #abcaff
participant "Direct Billing Bundle UI" #c3ffcd
participant "2019" #abcaff
participant "Webservice" #abcaff
participant "Commerce Insurance" #abcaff
participant "Commerce Customer" #abcaff
participant "Direct Billing Backend" #c3ffcd
database "Redis" #yellow
database "Mysql" #fdda14

autonumber
Customer -> FE:Update the products of cart
FE -> 2019:POST /cart
2019 -> 2019:Update the cart
2019 -> "Commerce Insurance":POST /carts/{cart-id}/products
"Direct Billing Backend" --> "Commerce Insurance":Response the new insurance details
note right
<font color=red>CLAIM_CANCELLED
<font color=green>QUOTE_APPLIED
end note
"Commerce Insurance" -> "Mysql":Insert the insurance details
"Mysql" --> "Commerce Insurance":Response
"Commerce Insurance" --> 2019:Response
"2019" -> FE:Response
FE -> FE:Refresh the product list and cart total price on the page. Refresh the quick cart.

@enduml

